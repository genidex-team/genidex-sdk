{"version":3,"file":"same.nonce copy.js","sourceRoot":"","sources":["../../../examples/same.nonce copy.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,cAAc,CAAC;AACtE,OAAO,EAAE,MAAM,EAAE,WAAW,EAAE,UAAU,EAAqB,MAAM,QAAQ,CAAC;AAC5E,OAAO,EAAE,MAAM,EAAE,MAAM,gBAAgB,CAAC;AAGxC,IAAI,OAAO,GAAI,IAAI,OAAO,EAAE,CAAC;AAC7B,IAAI,MAAc,CAAC;AACnB,IAAI,aAAqB,CAAC;AAC1B,MAAM,WAAW,GAAG,SAAS,CAAC,WAAW,CAAC;AAC1C,IAAI,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;AAE/B,KAAK,UAAU,IAAI;IACf,MAAM,GAAG,MAAM,MAAM,CAAC,SAAS,EAAE,CAAC;IAClC,aAAa,GAAG,MAAM,MAAM,CAAC,UAAU,EAAE,CAAC;IAC1C,MAAM,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;IAEvD,gBAAgB;IAChB,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,EAAE,WAAW,CAAC,CAAA;IAC9E,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;IAE/C,YAAY;IACZ,kDAAkD;IAClD,kDAAkD;IAClD,MAAM,QAAQ,CAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;IAEhD,MAAM,KAAK,GAAG,MAAM,QAAQ,CAAC,mBAAmB,CAAC,aAAa,CAAC,CAAC;IAChE,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAA;IAE3B,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC;IACrB,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC;IAErB,kDAAkD;IAClD,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAA;IACpC,MAAM,QAAQ,CAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;AAGnD,CAAC;AAED,KAAK,UAAU,OAAO,CAAC,KAAU;IAC7B,IAAI,EAAO,CAAC;IACZ,IAAG,CAAC;QACA,EAAE,GAAG,MAAM,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;YACnC,MAAM;YACN,UAAU,EAAE,UAAU,CAAC,GAAG,CAAC;YAC3B,SAAS,EAAE;gBACP,QAAQ,EAAE,MAAM,CAAC,UAAU,CAAC,IAAI,EAAE,MAAM,CAAC;gBACzC,KAAK;aACR;SACJ,CAAC,CAAC;IACP,CAAC;IAAA,OAAM,KAAU,EAAC,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,6CAA6C,CAAC,CAAA;QAC5D,sBAAsB;QACtB,6BAA6B;QAC7B,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC1B,CAAC;IACD,IAAG,EAAE,EAAC,CAAC;QACH,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,EAAC,EAAE;YACrC,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAA;YAC1D,OAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,EAAC,EAAE;YACd,sBAAsB;YACtB,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAA;IACN,CAAC;AACL,CAAC;AAED,KAAK,UAAU,OAAO,CAAC,KAAU;IAC7B,IAAI,EAAO,CAAC;IACZ,IAAG,CAAC;QACA,EAAE,GAAG,MAAM,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;YACnC,MAAM;YACN,UAAU,EAAE,UAAU,CAAC,GAAG,CAAC;YAC3B,SAAS,EAAE;gBACP,QAAQ,EAAE,MAAM,CAAC,UAAU,CAAC,IAAI,EAAE,MAAM,CAAC;gBACzC,KAAK;aACR;SACJ,CAAC,CAAC;IACP,CAAC;IAAA,OAAM,KAAU,EAAC,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,6CAA6C,CAAC,CAAA;QAC5D,sBAAsB;QACtB,6BAA6B;QAC7B,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC1B,CAAC;IACD,IAAG,EAAE,EAAC,CAAC;QACH,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,EAAC,EAAE;YACrC,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAA;YAC1D,OAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,EAAC,EAAE;YACd,sBAAsB;YACtB,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAA;IACN,CAAC;AAEL,CAAC;AAED,IAAI,EAAE,CAAC","sourcesContent":["\nimport { GeniDex, NetworkName, constants, utils } from \"../src/index\";\nimport { ethers, formatEther, parseEther, Signature, Signer } from \"ethers\";\nimport { config } from \"../test/config\";\nimport { error } from \"console\";\n\nlet genidex  = new GeniDex();\nlet signer: Signer;\nlet signerAddress: string;\nconst ETH_ADDRESS = constants.ETH_ADDRESS;\nlet provider = config.provider;\n\nasync function main(){\n    signer = await config.getSigner();\n    signerAddress = await signer.getAddress();\n    await genidex.connect(NetworkName.Localhost, provider);\n\n    // Check balance\n    const balance1 = await genidex.balances.getBalance(signerAddress, ETH_ADDRESS)\n    console.log('Balance1', formatEther(balance1));\n\n    // stop mine\n    // await provider.send(\"evm_setAutomine\", [true]);\n    // await new Promise((r) => setTimeout(r, 1_000));\n    await provider.send(\"evm_setAutomine\", [false]);\n\n    const nonce = await provider.getTransactionCount(signerAddress);\n    console.log('nonce', nonce)\n\n    await sendTx1(nonce);\n    await sendTx2(nonce);\n\n    // await new Promise((r) => setTimeout(r, 5_000));\n    console.log('evm_setAutomine', true)\n    await provider.send(\"evm_setAutomine\", [true]);\n\n\n}\n\nasync function sendTx1(nonce: any){\n    let tx: any;\n    try{\n        tx = await genidex.balances.depositEth({\n            signer,\n            normAmount: parseEther(\"1\"),\n            overrides: {\n                gasPrice: ethers.parseUnits(\"20\", \"gwei\"),\n                nonce\n            }\n        });\n    }catch(error: any){\n        console.error(\"\\n\\n========== send tx1 fail ==============\")\n        // console.log(error);\n        // console.log(error.payload)\n        utils.logError(error);\n    }\n    if(tx){\n        genidex.tx.wait(tx.hash).then((receipt)=>{\n            console.log(\"\\n\\n========== tx1 confirmed ==============\")\n            console.log('receipt?.status:', receipt?.status);\n        }).catch((error)=>{\n            // console.log(error);\n            utils.logError(error);\n        })\n    }\n}\n\nasync function sendTx2(nonce: any){\n    let tx: any;\n    try{\n        tx = await genidex.balances.depositEth({\n            signer,\n            normAmount: parseEther(\"1\"),\n            overrides: {\n                gasPrice: ethers.parseUnits(\"40\", \"gwei\"),\n                nonce\n            }\n        });\n    }catch(error: any){\n        console.error(\"\\n\\n========== send tx2 fail ==============\")\n        // console.log(error);\n        // console.log(error.payload)\n        utils.logError(error);\n    }\n    if(tx){\n        genidex.tx.wait(tx.hash).then((receipt)=>{\n            console.log(\"\\n\\n========== tx2 confirmed ==============\")\n            console.log('receipt?.status:', receipt?.status);\n        }).catch((error)=>{\n            // console.log(error);\n            utils.logError(error);\n        })\n    }\n    \n}\n\nmain();"]}